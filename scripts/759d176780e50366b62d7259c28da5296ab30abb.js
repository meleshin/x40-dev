(function(){$(function(){function loadClip(e,n){var t="video-bg-wrap"==n?!0:!1,i=$(t?"#"+n+" .video-bg>video":"#"+n+" .img-bg>img"),o=i.length;if(o<e.length){var a=e[o],r=a.w,s=a.h,c=function(){var e,n,t=$(window).width(),i=$(window).height(),o=r/s,a=t/i;o>a?(n=i,e=Math.round(n*o)):(e=t,n=Math.round(e/o));var c=Math.round((i-n)/2),d=Math.round((t-e)/2);return{width:e+"px",height:n+"px",left:d+"px",top:c+"px"}},d=$(t?'<div class="video-bg"></div>':'<div class="img-bg"></div>');d.appendTo("#"+n),d.css(c()),$(window).on("resize",function(){d.css(c())});var l;t?(l=$('<video class="bg" webkit-playsinline loop style="display:none;"></video>'),l[0].muted=a.audio?!1:!0):l=$('<img class="bg" />');var u=function(){l.appendTo(d),a.loadQ&&a.loadQ(l),loadClip(e,n)};t?l.one("canplaythrough",u):l.load(u),l[0].src=a.src,t&&l[0].load()}}function sketchExec(e,n){if(isProcessing){var t=Processing.getInstanceById(e);t?n(t):setTimeout(function(){sketchExec(e,n)},100)}}function moveClear(e){if(e)$(".page-paper.move-out").cssAnOnly({"background-color":""}).removeClass("move-out");else{var n=$(lastHash+" .page-paper");n.addClass("move-out"),n.cssAnOnly({"background-color":"rgba(0, 0, 0, 0)"})}}function design(){var e=function(){$(".navbar-collapse.in, #side-padding.in").collapse("hide"),$("#side-padding").css("height","")};$(".navbar-collapse").click("li",e),$(window).on("resize",function(){e(),isProcessing&&$(".in .sketch").each(function(){sketchExec(this.id,function(e){var n=$(lastHash+" .page-paper");e.size(n.width(),n.height())})})});var n=$(".page");n.wrapInner('<div class="col-sm-9 page-content"></div>'),$('<div class="col-sm-3 right"><div class="bg-author"></div></div>').appendTo(n),n.wrapInner('<div class="page-paper"></div>'),$('<div class="film1"></div>').insertBefore($(".page-paper")),$('<div class="film2"></div>').insertAfter($(".page-paper")),$(".page-paper").scroll(function(){var e=Math.round($(this).scrollTop()/4),n=Math.abs((180+e)%360-180),t=Math.abs((360+e)%360-180),i=Math.abs((300+e)%360-180);$("#side-nav").css(Modernizr.opacity?{"background-color":"rgba("+n+", "+t+", "+i+", 0.7)"}:{"background-color":"rgb("+n+", "+t+", "+i+")"})}),$("#side-nav a, #top-nav ul a").each(function(){$(this).attr("data-hover",$(this).text())}),isParallax&&($("#sketch-bg-wrap, #video-bg-wrap").addClass("layer").attr("data-depth","1"),$scene=$("#page-wrapper").parallax());var t,i,o=(new Date).getTime(),a=!1;$(window).mousemove(function(){var e=function(){var n=500,i=(new Date).getTime();i-o>n?(moveFunc(!0),a=!1):(t&&clearTimeout(t),t=setTimeout(e,n))};a&&i==lastHash||(a=!0,moveFunc(),e()),o=(new Date).getTime(),i=lastHash})}function navigation(){function e(e){function n(){if(isProcessing){$(".sketch").each(function(){var e=this;sketchExec(this.id,function(n){n.noLoop(),$(e).css({visibility:"hidden"})})});var e=sketches[sketchCursor].src;$.cookie("lastSketchCursor",sketchCursor);var n,t=e.replace("/","-").replace(".","-")+"-"+sketchCursor;if(0===$("#"+t).length){var n=$('<canvas id="'+t+'" class="sketch" tabindex="0"></canvas>');$(v+" .page-content").prepend(n),Processing.loadSketchFromSources(t,[e]),sketchExec(t,function(){n.cssAn({opacity:1})})}else{var i=$("#"+t);i.detach(),$(v+" .page-content").prepend(i),sketchExec(t,function(e){var n=$(v+" .page-paper");e.size(n.width(),n.height()),i.css({visibility:"visible"}).cssAn({opacity:1}),e.loop()})}sketchCursor<sketches.length-1?sketchCursor++:sketchCursor=0}}function t(){var e=threeBgs[threeCursor];return threeCursor<threeBgs.length-1?threeCursor++:threeCursor=0,$.cookie("lastThreeCursor",threeCursor),moveFunc=moveClear,e.start(),e}function i(){for(var e=0;e<threeBgs.length;e++)threeBgs[e].stop()}function r(e,n,t){var i=$("#"+e+" .bg"),o=i.length;clipCursor[e]>=o&&(clipCursor[e]=0);var a=clipCursor[e];clipCursor[e]++,$.cookie("last-cursor-"+e,clipCursor[e]),a>=o?n[a].loadQ=function(e){n[a].loadQ=!1,t(e,a)}:t($(i[a]),a)}function s(){isPlayVideo&&$(".video-bg video").each(function(e){videoClips[e].videoFx&&videoClips[e].videoFx.stop()}),isWebgl&&i(),isProcessing&&$(".sketch").each(function(){var e=this;sketchExec(this.id,function(n){n.noLoop(),$(e).css({opacity:0})})})}function c(){function e(){var e=pgOutClassCur<pgOutClasses.length-1?pgOutClassCur+1:0,n=pgOutClasses[pgOutClassCur];return pgOutClassCur=e,n}$(".page.in").each(function(){var n=$(this);if("#"+n.attr("id")!=lastHash){var t=e();n.removeClass("in "+pgInClasses.join(" ")).addClass("animated out "+t)}})}function d(){function e(){var e=bgOutClassCur<bgOutClasses.length-1?bgOutClassCur+1:0,n=bgOutClasses[bgOutClassCur];return bgOutClassCur=e,n}$(".bg.in").each(function(){var n=e();$(this).removeClass("in "+bgInClasses.join(" ")).addClass("animated out "+n)})}function l(e,n){function t(){$(".page.in .bg-author").empty(),n&&n()}if(Modernizr.cssanimations){var i=function(){var e=bgInClassCur<bgInClasses.length-1?bgInClassCur+1:0,n=bgInClasses[bgInClassCur];return bgInClassCur=e,n}();c(),e.hasClass("in")?t():(d(),e.removeClass("out "+bgOutClasses.join(" ")).addClass("over in"),e.one(animationEnd,t),e.addClass("animated "+i))}else e.addClass("over in"),e.css({top:"-100%"}),e.animate({top:"0"},t)}function u(n,t,i){function r(){if(t.removeClass("over"),n.removeClass("over"),n.find(".box").removeClass(d),"#"+n.attr("id")==lastHash){if($.support.transition){var o,a=$(v+" .film1, "+v+" .film2"),r=a.css("background-position");o=r?r.split(" ")[0].replace("%","").replace("px",""):"0",filmDirect=-1*filmDirect;var s="0"==o?504*filmDirect*4:"0";setTimeout(function(){a.css({"background-position":s+"px 0"})},100)}var l=$(v+" .page-paper"),u=l.getNiceScroll(0);u?u.show():(l.niceScroll({zindex:1e5,autohidemode:!0,horizrailenabled:!1,cursoropacitymin:.6,cursoropacitymax:1,background:"transparent",cursorborder:"1px solid #fff",cursorwidth:"8px",cursorcolor:"rgb(200, 0, 0)"}),$(v+" .nicescroll-rails").detach().appendTo("body")),$("a").each(function(){$(this).parents("li").removeClass("active"),$(this).removeClass("active"),(this.href==e.href||this.href+"#"==e.href)&&($(this).parents("li").addClass("active"),$(this).addClass("active"))}),seq&&seq.startAutoPlay(),i&&i()}c()}if($("#side-nav a").css("color",""),Modernizr.opacity&&($(v+" .page-paper").cssAnOnly({"background-color":""}),o.cssAn({"background-color":a})),$(".page-paper").each(function(){var e=$(this).getNiceScroll(0);e&&e.hide()}),Modernizr.cssanimations){var s=function(){var e=pgInClassCur<pgInClasses.length-1?pgInClassCur+1:0,n=pgInClasses[pgInClassCur];return pgInClassCur=e,n}(),d=function(){var e=boxInClassCur<boxInClasses.length-1?boxInClassCur+1:0,n=boxInClasses[boxInClassCur];return boxInClassCur=e,n}();n.find(".page-box").addClass("animated "+d),n.removeClass("out "+pgOutClasses.join(" ")).addClass("over in"),n.one(animationEnd,r),n.addClass("animated "+s)}else n.addClass("over in"),n.css({left:"-100%"}),n.animate({left:"0"},r)}function h(){s();var e="video-bg-wrap";r(e,videoClips,function(e,n){var t=videoClips[n];t.videoFx||(t.videoFx=isIE?new SimpleVideo(e[0]):new ThreeVideo(e[0]));var i=$(t.videoFx.container);t.videoFx.start(),l(i,function(){t.link&&t.author&&$(v+" .bg-author").text("Видео: ").append('<a target="_blank" href="'+t.link+'">'+t.author+"</a>"),u(m,i,function(){e[0].play()})})})}function p(){s();var e=t(),n=$(e.container);l(n,function(){u(m,n)})}function g(){s();var e="sketch-bg-wrap";r(e,sketchClips,function(e,t){var i=sketchClips[t];l(e,function(){i.link&&i.author&&$(v+" .bg-author").text("Фон: ").append('<a target="_blank" href="'+i.link+'">'+i.author+"</a>"),u(m,e,function(){n()})})})}var v=e.hash;v=v&&"#"!=v?v.replace("#!","#"):"#index",lastHash=v;var m=$(v);if(!(m.length<1)){$(".page.in").length>0&&($("#side-nav a").css("color","#FF7D8D"),Modernizr.opacity&&o.cssAn({"background-color":"rgba(0, 0, 0, 0.7)"}));var f=function(){var e=[],n=function(){isPlayVideo&&e.push(h)},t=function(){isPlayVideo||isWebgl||e.push(g)},i=function(){isWebgl&&e.push(p)};return isIE?(i(),n(),n(),n(),i(),n(),n(),t()):(i(),i(),i(),n(),n(),i(),n(),i(),n(),i(),n(),t()),e}();f[fxCursor](),fxCursor<f.length-1?fxCursor++:fxCursor=0,$.cookie("lastFxCursor",fxCursor)}}var n=!1,t=!1,i=null,o=$("#side-nav"),a=o.css("background-color");$("a").each(function(){this.hash&&(this.hash=this.hash.replace("#","#!"))}),$(window).on("resize",function(){$("#page-wrapper>img.in").each(function(){adjustImg(this)})}),e(location),$("a").click(function(a){function r(){$(".video-bg video").each(function(){this.pause()}),$("#off").css({display:"none"}),$("#on").css({display:"block"}),o.cssAn({opacity:.3});var e=$("#off-bg");e.css({display:"table","background-image":"url(/images/fuzz.gif)"}),setTimeout(function(){e.cssAn({opacity:1})}),n=!0,i=location.hash}function s(){$("#off").css({display:"block"}),$("#on").css({display:"none"});var e=$("#off-bg");e.cssAn({opacity:0}),o.cssAn({opacity:1});var t=$.support.transition?300:duration;setTimeout(function(){e.css({display:"none","background-image":"none"})},t);var i=$(".video-bg video.in");i.length>0&&($(".video-bg video").each(function(){this.pause()}),i[0].play()),n=!1}if("?off=1"===this.search)n||r(),a.preventDefault();else if("?on=1"==this.search)n&&s(),a.preventDefault();else if(t)a.preventDefault();else{n&&s();var c=location.hash?location.href.replace(location.hash,""):location.href.replace(/#$/,""),d=this.hash?this.href.replace(this.hash,""):this.href.replace(/#$/,"");this.hash&&d==c?(e(this),i=this.hash,location.hash=this.hash,a.preventDefault()):d==c&&(e(this),i="",location.hash="",a.preventDefault())}}),$(window).on("hashchange",function(){var n="#"==location.hash?"":location.hash;n!==i&&e(location)})}function projects(){var e=$("#sequence");if(e.length>0){var n={nextButton:!0,prevButton:!0,pagination:!0,animateStartingFrameIn:!0,autoPlay:!0,pauseOnHover:!1,autoPlayDelay:3e3,preloader:!0,preloadTheseFrames:[1],preloadTheseImages:["images/newbigjob-t.png","images/newbigjob-m-t.png","images/mobivisor-t.png","images/surwave-t.png","images/surwave-m-t.png","images/vreggy-t.png","images/sigmahome-t.png","images/hitechhow-t.png","images/hth-crm-t.png","images/frescostudio-t.png"]},t=function(){$("#sequence>.sequence-canvas div[data-img]").each(function(){var e=$(this),n=e.attr("data-img"),t=$(window).width(),i=$(window).height();Modernizr.mq("only all")&&(580>=t||602>=i?n=n.replace(".png","-c.png"):925>=t||695>=i?n=n.replace(".png","-b.png"):(1199>=t||755>=i)&&(n=n.replace(".png","-a.png")));var o=e.find("img");(o.length<1||o.attr("src")!==n)&&(e.empty(),$('<img src="'+n+'" />').appendTo(e))})};$("#sequence .sequence-pagination .view").length<1&&($("#sequence>.sequence-canvas>li>.view").each(function(){var e=$(this).clone();e.find("div[data-img]").each(function(){var e=$(this);src=e.attr("data-img").replace(".png","-t.png"),$('<img src="'+src+'" />').appendTo(e)}),e.appendTo("#sequence .sequence-pagination")}),t(),$(window).on("resize",t)),seq=$("#sequence").sequence(n).data("sequence"),seq.pause()}}function opacityFix(){if(!Modernizr.opacity){for(var e=[["#top-nav",70],["#top-nav .navbar-toggle",80],["#top-nav .navbar-toggle:focus",20],["#top-nav li.navbar-text",80],["#side-nav",75],[".page-paper",90],[".page-content i",72],["#off-bg i",20],[".center-menu, .page-box",70],[".descr",70]],n=$("head"),t='<style type="text/css">',i=0;i<e.length;i++)t+=e[i][0]+' {-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity='+e[i][1]+')";}';t+="</style>",n.append($(t))}}function ThreeCubemapBalls(){function e(){p=window.innerWidth/2,g=window.innerHeight/2,i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)}function n(e){u=10*(e.clientX-p),h=10*(e.clientY-g)}function t(){for(var e=1e-4*Date.now(),n=0,t=l.length;t>n;n++){var c=l[n];c.position.x=5e3*Math.cos(e+n),c.position.y=5e3*Math.sin(e+1.1*n)}i.position.x+=.05*(u-i.position.x),i.position.y+=.05*(-h-i.position.y),i.lookAt(o.position),r.rotation.copy(i.rotation),a.render(s,r),a.render(o,i)}var i,o,a,r,s,c,d,l=[],u=0,h=0,p=window.innerWidth/2,g=window.innerHeight/2;document.addEventListener("mousemove",n,!1);var v;this.container=document.createElement("div"),$(this.container).addClass("bg three"),$("#three-bg-wrap").append(this.container),i=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e5),i.position.z=3200,r=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e5),o=new THREE.Scene,s=new THREE.Scene;for(var d=new THREE.SphereGeometry(100,32,16),m="textures/cube/skybox-blue/",f=".jpg",w=[m+"px"+f,m+"nx"+f,m+"py"+f,m+"ny"+f,m+"pz"+f,m+"nz"+f],E=THREE.ImageUtils.loadTextureCube(w,new THREE.CubeRefractionMapping),C=new THREE.MeshBasicMaterial({color:16777215,envMap:E,refractionRatio:.95}),b=0;500>b;b++){var c=new THREE.Mesh(d,C);c.position.x=1e4*Math.random()-5e3,c.position.y=1e4*Math.random()-5e3,c.position.z=1e4*Math.random()-5e3,c.scale.x=c.scale.y=c.scale.z=3*Math.random()+1,o.add(c),l.push(c)}var T=THREE.ShaderLib.cube;T.uniforms.tCube.value=E;var C=new THREE.ShaderMaterial({fragmentShader:T.fragmentShader,vertexShader:T.vertexShader,uniforms:T.uniforms,depthWrite:!1,side:THREE.BackSide}),c=new THREE.Mesh(new THREE.CubeGeometry(100,100,100),C);s.add(c),a=new THREE.WebGLRenderer,a.setSize(window.innerWidth,window.innerHeight),a.autoClear=!1,this.container.appendChild(a.domElement),window.addEventListener("resize",e,!1),this.stop=function(){v=!1},this.start=function(){function e(){v&&(requestAnimationFrame(e),t())}v=!0,e()}}function ThreeParticlesBillboards(){function e(){f=window.innerWidth/2,w=window.innerHeight/2,a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)}function n(e){v=e.clientX-f,m=e.clientY-w}function t(e){1==e.touches.length&&(e.preventDefault(),v=e.touches[0].pageX-f,m=e.touches[0].pageY-w)}function i(e){1==e.touches.length&&(e.preventDefault(),v=e.touches[0].pageX-f,m=e.touches[0].pageY-w)}function o(){var e=5e-5*Date.now();a.position.x+=.05*(v-a.position.x),a.position.y+=.05*(-m-a.position.y),a.lookAt(r.position),h=360*(1+e)%360/360,l.color.setHSL(h,.5,.5),s.render(r,a)}var a,r,s,c,d,l,u,h,p,g,v=0,m=0,f=window.innerWidth/2,w=window.innerHeight/2;for(this.container=document.createElement("div"),$(this.container).addClass("bg three"),$("#three-bg-wrap").append(this.container),a=new THREE.PerspectiveCamera(55,window.innerWidth/window.innerHeight,2,2e3),a.position.z=1e3,r=new THREE.Scene,r.fog=new THREE.FogExp2(0,.001),d=new THREE.Geometry,p=THREE.ImageUtils.loadTexture("textures/sprites/disc.png"),u=0;1e4>u;u++){var E=new THREE.Vector3;E.x=2e3*Math.random()-1e3,E.y=2e3*Math.random()-1e3,E.z=2e3*Math.random()-1e3,d.vertices.push(E)}l=new THREE.ParticleSystemMaterial({size:35,sizeAttenuation:!1,map:p,transparent:!0}),l.color.setHSL(1,.3,.7),c=new THREE.ParticleSystem(d,l),c.sortParticles=!0,r.add(c),s=new THREE.WebGLRenderer({clearAlpha:1}),s.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(s.domElement),document.addEventListener("mousemove",n,!1),document.addEventListener("touchstart",t,!1),document.addEventListener("touchmove",i,!1),window.addEventListener("resize",e,!1),this.stop=function(){g=!1},this.start=function(){function e(){g&&(requestAnimationFrame(e),o())}g=!0,e()}}function ThreeParticlesShapes(){function e(e,n,t){return new THREE.Vector3(e,n,t)}function n(){var e=document.createElement("canvas");e.width=128,e.height=128;var n=e.getContext("2d");n.beginPath(),n.arc(64,64,60,0,2*Math.PI,!1),n.lineWidth=.5,n.stroke(),n.restore();var t=n.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return t.addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(.2,"rgba(255,255,255,1)"),t.addColorStop(.4,"rgba(200,200,200,1)"),t.addColorStop(1,"rgba(0,0,0,1)"),n.fillStyle=t,n.fill(),e}function t(){k=window.innerWidth/2,P=window.innerHeight/2,d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight),b.uniforms.h.value=1/window.innerWidth,T.uniforms.v.value=1/window.innerHeight;var e=15,n=e/window.innerWidth,t=e/window.innerHeight;E.uniforms.delta.value=new THREE.Vector2(n,0),C.uniforms.delta.value=new THREE.Vector2(0,t),w.reset()}function o(e){e.preventDefault(),I=e.clientX-k,y=R,f.isRunning()?f.stop():f.start()}function a(e){S=e.clientX-k,R=y+.02*(S-I)}function r(e){1===e.touches.length&&(e.preventDefault(),I=e.touches[0].pageX-k,y=R)}function s(e){1===e.touches.length&&(e.preventDefault(),S=e.touches[0].pageX-k,R=y+.05*(S-I))}function c(){M=x*z.getDelta(),m.geometry.verticesNeedUpdate=!0,attributes.size.needsUpdate=!0,attributes.pcolor.needsUpdate=!0,h.rotation.y+=.05*(R-h.rotation.y),u.clear(),w.render(.1)}var d,l,u,h,p,g,v,m,f,w,E,C,b,T,H,x=50,R=0,y=0,S=0,I=0,k=window.innerWidth/2,P=window.innerHeight/2,M=1,z=new THREE.Clock,A=0;this.container=document.createElement("div"),$(this.container).addClass("bg three"),$("#three-bg-wrap").append(this.container),d=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,2e3),d.position.set(0,150,400),l=new THREE.Scene;var W=new THREE.DirectionalLight(16777215,.5);W.position.set(0,-1,1),W.position.normalize(),l.add(W),g=new THREE.PointLight(16777215,2,300),g.position.set(0,0,0),l.add(g);var _="X40",O=new THREE.MeshFaceMaterial([new THREE.MeshLambertMaterial({color:16777215,shading:THREE.FlatShading,opacity:.95}),new THREE.MeshLambertMaterial({color:16777215})]),L=new THREE.TextGeometry(_,{size:70,height:25,curveSegments:4,font:"helvetiker",bevelEnabled:!0,bevelThickness:2,bevelSize:2,material:0,extrudeMaterial:1});L.computeVertexNormals(),L.computeBoundingBox();var F=-.5*(L.boundingBox.max.x-L.boundingBox.min.x);p=new THREE.Mesh(L,O),p.position.x=F,p.position.y=130,p.position.z=-50,p.rotation.x=0,p.rotation.y=2*Math.PI,h=new THREE.Object3D,h.add(p),l.add(h);var D=7e4,V=new THREE.Geometry,B={__pools:[],get:function(){return this.__pools.length>0?this.__pools.pop():(console.log("pool ran out!"),null)},add:function(e){this.__pools.push(e)}};for(i=0;D>i;i++)V.vertices.push(e(200*Math.random()-100,100*Math.random()+150,50*Math.random())),B.add(i);attributes={size:{type:"f",value:[]},pcolor:{type:"c",value:[]}};var q=n();texture=new THREE.Texture(q),texture.needsUpdate=!0,uniforms={texture:{type:"t",value:texture}};var j=new THREE.ShaderMaterial({uniforms:uniforms,attributes:attributes,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:THREE.AdditiveBlending,depthWrite:!1,transparent:!0});m=new THREE.ParticleSystem(V,j),m.dynamic=!0;for(var N=m.geometry.vertices,G=attributes.size.value,U=attributes.pcolor.value,K=0;K<N.length;K++)G[K]=50,U[K]=new THREE.Color(0),V.vertices[K].set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);h.add(m),m.y=800;var X=0,Y=0;v=new THREE.Shape,v.moveTo(X+25,Y+25),v.bezierCurveTo(X+25,Y+25,X+20,Y,X,Y),v.bezierCurveTo(X-30,Y,X-30,Y+35,X-30,Y+35),v.bezierCurveTo(X-30,Y+55,X-10,Y+77,X+25,Y+95),v.bezierCurveTo(X+60,Y+77,X+80,Y+55,X+80,Y+35),v.bezierCurveTo(X+80,Y+35,X+80,Y,X+50,Y),v.bezierCurveTo(X+35,Y,X+25,Y+25,X+25,Y+25);var Q=0,Z=function(){var e=B.get();return G[e]=200*Math.random()+100,e},J=function(e){var n=e.position;e.target.position=n;var t=e.target;if(t){Q+=3e-4*M,Q>1&&(Q-=1),A+=35e-5*M,A>1&&(A-=1);var i=v.getPointAt(A);emitterpos.x=5*i.x-100,emitterpos.y=5*-i.y+400,g.position.x=emitterpos.x,g.position.y=emitterpos.y,g.position.z=100,V.vertices[t]=e.position,U[t].setHSL(Q,.6,.1),g.color.setHSL(Q,.8,.5)}},en=function(e){var n=e.target;n&&(U[n].setRGB(0,0,0),V.vertices[n].set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),B.add(e.target))};f=new SPARKS.Emitter(new SPARKS.SteadyCounter(500)),emitterpos=new THREE.Vector3(0,0,0),f.addInitializer(new SPARKS.Position(new SPARKS.PointZone(emitterpos))),f.addInitializer(new SPARKS.Lifetime(1,15)),f.addInitializer(new SPARKS.Target(null,Z)),f.addInitializer(new SPARKS.Velocity(new SPARKS.PointZone(new THREE.Vector3(0,-5,1)))),f.addAction(new SPARKS.Age),f.addAction(new SPARKS.Accelerate(0,0,-50)),f.addAction(new SPARKS.Move),f.addAction(new SPARKS.RandomDrift(90,100,2e3)),f.addCallback("created",J),f.addCallback("dead",en),f.start(),u=new THREE.WebGLRenderer,u.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(u.domElement);var nn=new THREE.ShaderPass(THREE.FocusShader),tn=new THREE.ShaderPass(THREE.CopyShader);effectFilm=new THREE.FilmPass(.5,.25,2048,!1);var on=THREE.TriangleBlurShader;E=new THREE.ShaderPass(on,"texture"),C=new THREE.ShaderPass(on,"texture");var an=15,rn=an/window.innerWidth,sn=an/window.innerHeight;b=new THREE.ShaderPass(THREE.HorizontalBlurShader),T=new THREE.ShaderPass(THREE.VerticalBlurShader),b.uniforms.h.value=1/window.innerWidth,T.uniforms.v.value=1/window.innerHeight,E.uniforms.delta.value=new THREE.Vector2(rn,0),C.uniforms.delta.value=new THREE.Vector2(0,sn),nn.uniforms.sampleDistance.value=.99,nn.uniforms.waveFactor.value=.003;var cn=new THREE.RenderPass(l,d);w=new THREE.EffectComposer(u),w.addPass(cn),w.addPass(b),w.addPass(T),T.renderToScreen=!0,C.renderToScreen=!0,nn.renderToScreen=!0,tn.renderToScreen=!0,effectFilm.renderToScreen=!0,document.addEventListener("mousedown",o,!1),document.addEventListener("touchstart",r,!1),document.addEventListener("touchmove",s,!1),window.addEventListener("resize",t,!1),document.addEventListener("mousemove",a,!1),this.stop=function(){H=!1},this.start=function(){function e(){H&&(requestAnimationFrame(e),c())}H=!0,THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),e()}}function SimpleVideo(e){var n=$(e);this.container=e,n.css({display:"block"}),$(this.container).addClass("bg"),this.stop=function(){e.pause()},this.start=function(){}}function ThreeVideo(e){function n(){m=window.innerWidth/2,f=window.innerHeight/2,a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight),u.reset()}function t(e,n,t,i,o){for(var a=e.faceVertexUvs[0],r=0;r<a.length;r++)for(var s=a[r],c=0;c<s.length;c++){var d=s[c];d.x=(d.x+i)*n,d.y=(d.y+o)*t}}function i(e){g=e.clientX-m,v=.3*(e.clientY-f)}function o(){var n=5e-5*Date.now();for(a.position.x+=.05*(g-a.position.x),a.position.y+=.05*(-v-a.position.y),a.lookAt(r.position),e.readyState===e.HAVE_ENOUGH_DATA&&c&&(c.needsUpdate=!0),x=0;h>x;x++)d=E[x],F=360*(d.hue+n)%360/360,d.color.setHSL(F,d.saturation,.5);if(D%1e3>200)for(x=0;h>x;x++)l=w[x],l.rotation.x+=10*l.dx,l.rotation.y+=10*l.dy,l.position.x+=200*l.dx,l.position.y+=200*l.dy,l.position.z+=400*l.dx;if(D%1e3===0)for(x=0;h>x;x++)l=w[x],l.dx*=-1,l.dy*=-1;D++,s.clear(),u.render()}var a,r,s,c,d,l,u,h,p,g=0,v=0,m=window.innerWidth/2,f=window.innerHeight/2,w=[],E=[],C=20,b=10,T=$(e);T.css({display:"none"}),this.container=document.createElement("div"),T.removeClass("bg"),$(this.container).addClass("bg three"),$("#three-bg-wrap").append(this.container),a=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e4),a.position.z=500,r=new THREE.Scene;var H=new THREE.DirectionalLight(16777215);H.position.set(.5,1,1).normalize(),r.add(H),s=new THREE.WebGLRenderer({antialias:!1}),s.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(s.domElement),c=new THREE.Texture(e),c.minFilter=THREE.LinearFilter,c.magFilter=THREE.LinearFilter,c.format=THREE.RGBFormat,c.generateMipmaps=!1;var x,R,y,S,I,k,P,M,z;y=1/C,S=1/b,M=T.width()/1.5/C,z=T.height()/1.5/b;var A={color:16777215,map:c},W=new THREE.MeshLambertMaterial(A);for(s.initMaterial(W,r.__lights,r.fog),h=0,x=0;C>x;x++)for(R=0;b>R;R++)I=x,k=R,P=new THREE.CubeGeometry(M,z,M),t(P,y,S,I,k),E[h]=new THREE.MeshLambertMaterial(A),d=E[h],d.hue=x/C,d.saturation=1-R/b,d.color.setHSL(d.hue,d.saturation,.5),l=new THREE.Mesh(P,d),l.position.x=(x-C/2)*M,l.position.y=(R-b/2)*z,l.position.z=0,l.scale.x=l.scale.y=l.scale.z=1,r.add(l),l.dx=.001*(.5-Math.random()),l.dy=.001*(.5-Math.random()),w[h]=l,h+=1;s.autoClear=!1,document.addEventListener("mousemove",i,!1);var _=new THREE.RenderPass(r,a),O=new THREE.BloomPass(1.3),L=new THREE.ShaderPass(THREE.CopyShader);L.renderToScreen=!0,u=new THREE.EffectComposer(s),u.addPass(_),u.addPass(O),u.addPass(L),window.addEventListener("resize",n,!1),this.stop=function(){p=!1,e.pause()},this.start=function(){function e(){p&&(requestAnimationFrame(e),o())}p=!0,THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),e()};var F,D=1}$.fn.cssAn=function(e){return Modernizr.cssanimations?this.css(e):this.animate(e,duration)},$.fn.cssAnOnly=function(e){return Modernizr.cssanimations?this.css(e):this};var isIE8=$("html").hasClass("ie8"),isIE9=$("html").hasClass("ie9"),isIE10=$("html").hasClass("ie10"),isIE11=function(){var e=document.documentMode;try{document.documentMode=""}catch(n){}res=11===document.documentMode;try{document.documentMode=e}catch(n){}return res}(),isIE=function(){var tmp=document.documentMode,e,isIE;try{document.documentMode=""}catch(e){}res="number"==typeof document.documentMode?!0:eval("/*@cc_on!@*/!1");try{document.documentMode=tmp}catch(e){}return res}(),isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,isWin=-1!=navigator.appVersion.indexOf("Win"),isWebgl=function(){try{var e=document.createElement("canvas"),n=e.getContext("webgl")||e.getContext("experimental-webgl"),t=window.WebGLRenderingContext&&n?!0:!1,i=n.getSupportedExtensions(),o=isWin&&isChrome&&-1==i.join().indexOf("compressed_texture");return t&&!o}catch(a){return!1}}(),isPlayVideo=function(){var e=document.createElement("video");return canMP4=e.canPlayType?e.canPlayType("video/mp4"):!1,canMP4&&(isWebgl||isIE10)&&!Modernizr.touch}(),isParallax=Modernizr.csstransforms,$scene,isProcessing=Modernizr.canvas,duration=800,bgInClasses=["slideInDown","fadeInLeft","slideInLeft","fadeInRight","slideInRight","fadeInDown","fadeInUp"],bgInClassCur=0,pgInClasses=["fadeInLeft","fadeInDown","fadeInUp","fadeInRight"],pgInClassCur=0,boxInClasses=["flipInX","bounceIn","pulse","bounce","shake","swing","bounceInLeft","flipInY"],boxInClassCur=0,pgOutClasses=["bounceOutRight","bounceOutLeft","bounceOutDown","bounceOutUp"],pgOutClassCur=0,bgOutClasses=["bounceOutRight","bounceOutLeft","bounceOutDown","bounceOutUp"],bgOutClassCur=0,animationEnd="animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",transitionEnd="webkitTransitionEnd oTransitionEnd transitionend",moveFunc=moveClear,clipCursor=function(){function e(e){var n="last-cursor-"+e,t=$.cookie(n);return t?t:($.cookie(n,0),0)}return{"video-bg-wrap":e("video-bg-wrap"),"sketch-bg-wrap":e("sketch-bg-wrap")}}(),fxCursor=function(){var e=$.cookie("lastFxCursor");return e?e:($.cookie("lastFxCursor",0),0)}(),sketchCursor=function(){var e=$.cookie("lastSketchCursor");return e?e:($.cookie("lastSketchCursor",0),0)}(),threeCursor=function(){var e=$.cookie("lastThreeCursor");return e?e:($.cookie("lastThreeCursor",0),0)}(),lastHash,loadedVideo=[],currentVideoUrl,filmDirect=1,seq,videoClips=[{src:"video/circ.hole_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/15533570",author:"beeple"},{src:"video/cross6_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/nodes_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/9936271",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"}],sketchClips=[{src:"video/lightgrid_(loop)_1280x720.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-a.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-a.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-c.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-c.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-b.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-b.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"}],sketches=[{src:"pde/hello-processing.pde"},{src:"pde/swarming-circles.pde"},{src:"pde/motion-frequency.pde"}],threeBgs=function(){return isWebgl?isIE?[new ThreeCubemapBalls]:[new ThreeCubemapBalls,new ThreeParticlesShapes,new ThreeParticlesBillboards]:null}();design(),projects(),loadClip(sketchClips,"sketch-bg-wrap"),isPlayVideo&&loadClip(videoClips,"video-bg-wrap"),navigation(),opacityFix()})}).call(this);