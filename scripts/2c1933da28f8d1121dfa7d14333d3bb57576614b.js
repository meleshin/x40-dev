(function(){$(function(){function e(n,t){var i="video-bg-wrap"==t?!0:!1,o=$(i?"#"+t+" .video-bg>video":"#"+t+" .img-bg>img"),a=o.length;if(a<n.length){var r=n[a],s=r.w,d=r.h,c=function(){var e,n,t=$(window).width(),i=$(window).height(),o=s/d,a=t/i;o>a?(n=i,e=Math.round(n*o)):(e=t,n=Math.round(e/o));var r=Math.round((i-n)/2),c=Math.round((t-e)/2);return{width:e+"px",height:n+"px",left:c+"px",top:r+"px"}},l=$(i?'<div class="video-bg"></div>':'<div class="img-bg"></div>');l.appendTo("#"+t),l.css(c()),$(window).on("resize",function(){l.css(c())});var u;i?(u=$('<video class="bg" webkit-playsinline loop"></video>'),u[0].muted=r.audio?!1:!0):u=$('<img class="bg" />');var h=function(){u.appendTo(l),r.loadQ&&r.loadQ(u),e(n,t)};i?u.one("canplaythrough",h):u.load(h),u[0].src=r.src,i&&u[0].load()}}function n(e,t){if(b){var i=Processing.getInstanceById(e);i?t(i):setTimeout(function(){n(e,t)},100)}}function t(e){if(e)$(".page-paper.move-out").cssAnOnly({"background-color":""}).removeClass("move-out");else{var n=$(p+" .page-paper");n.addClass("move-out"),n.cssAnOnly({"background-color":"rgba(0, 0, 0, 0)"})}}function o(){var e=function(){$(".navbar-collapse.in, #side-padding.in").collapse("hide"),$("#side-padding").css("height","")};$(".navbar-collapse").click("li",e),$(window).on("resize",function(){e(),b&&$(".in .sketch").each(function(){n(this.id,function(e){var n=$(p+" .page-paper");e.size(n.width(),n.height())})})});var t=$(".page");t.wrapInner('<div class="col-sm-9 page-content"></div>'),$('<div class="col-sm-3 right"><div class="bg-author"></div></div>').appendTo(t),t.wrapInner('<div class="page-paper"></div>'),$('<div class="film1"></div>').insertBefore($(".page-paper")),$('<div class="film2"></div>').insertAfter($(".page-paper")),$(".page-paper").scroll(function(){var e=Math.round($(this).scrollTop()/4),n=Math.abs((180+e)%360-180),t=Math.abs((360+e)%360-180),i=Math.abs((300+e)%360-180);$("#side-nav").css(Modernizr.opacity?{"background-color":"rgba("+n+", "+t+", "+i+", 0.7)"}:{"background-color":"rgb("+n+", "+t+", "+i+")"})}),$("#side-nav a, #top-nav ul a").each(function(){$(this).attr("data-hover",$(this).text())}),E&&($("#sketch-bg-wrap").addClass("layer").attr("data-depth","1"),h=$("#page-wrapper").parallax());var i,o,a=(new Date).getTime(),r=!1;$(window).mousemove(function(){var e=function(){var n=500,t=(new Date).getTime();t-a>n?(A(!0),r=!1):(i&&clearTimeout(i),i=setTimeout(e,n))};r&&o==p||(r=!0,A(),e()),a=(new Date).getTime(),o=p})}function a(){function e(e){function i(){if(b){$(".sketch").each(function(){var e=this;n(this.id,function(n){n.noLoop(),$(e).css({visibility:"hidden"})})});var e=N[W].src;$.cookie("lastSketchCursor",W);var t,i=e.replace("/","-").replace(".","-")+"-"+W;if(0===$("#"+i).length){var t=$('<canvas id="'+i+'" class="sketch" tabindex="0"></canvas>');$(T+" .page-content").prepend(t),Processing.loadSketchFromSources(i,[e]),n(i,function(){t.cssAn({opacity:1})})}else{var o=$("#"+i);o.detach(),$(T+" .page-content").prepend(o),n(i,function(e){var n=$(T+" .page-paper");e.size(n.width(),n.height()),o.css({visibility:"visible"}).cssAn({opacity:1}),e.loop()})}W<N.length-1?W++:W=0}}function o(e){var n=q[D].func;D<q.length-1?D++:D=0,$.cookie("lastThreeCursor",D),A=t,n(e)}function a(){for(var e=0;e<q.length;e++)q[e].func(!1)}function d(e,n,t){var i=$("#"+e+" .bg"),o=i.length;_[e]>=o&&(_[e]=0);var a=_[e];_[e]++,$.cookie("last-cursor-"+e,_[e]),a>=o?n[a].loadQ=function(e){n[a].loadQ=!1,t(e,n[a])}:t($(i[a]),n[a])}function c(){m&&$(".video-bg video").each(function(e){u(!1,e),this.pause()}),f&&(a(),$("#three-bg-wrap div").addClass("stoped")),b&&$(".sketch").each(function(){var e=this;n(this.id,function(n){n.noLoop(),$(e).css({opacity:0})})})}function l(e,n){function t(){$("#three-bg-wrap div.stoped").remove(),$(".page.in .bg-author").empty(),n&&n()}if(Modernizr.cssanimations){var i=function(){var e=M<k.length-1?M+1:0,n=k[M];return M=e,n}(),o=function(){var e=P<z.length-1?P+1:0,n=z[P];return P=e,n}(),a=function(){var e=R<H.length-1?R+1:0,n=H[R];return R=e,n}();$(".page.in").removeClass("in "+x.join(" ")).addClass("animated out "+i),$(".bg.in").removeClass("in "+H.join(" ")).addClass("animated out "+o),e.removeClass("out "+z.join(" ")).addClass("over in"),e.one(I,t),e.addClass("animated "+a)}else e.addClass("over in"),e.css({top:"-100%"}),e.animate({top:"0"},t)}function h(n,t,i){function o(){if(t.removeClass("over"),n.removeClass("over"),n.find(".box").removeClass(d),$.support.transition){var o,a=$(T+" .film1, "+T+" .film2"),r=a.css("background-position");o=r?r.split(" ")[0].replace("%","").replace("px",""):"0",F=-1*F;var s="0"==o?504*F*4:"0";setTimeout(function(){a.css({"background-position":s+"px 0"})},100)}var c=$(T+" .page-paper"),l=c.getNiceScroll(0);l?l.show():(c.niceScroll({zindex:1e5,autohidemode:!0,horizrailenabled:!1,cursoropacitymin:.6,cursoropacitymax:1,background:"transparent",cursorborder:"1px solid #fff",cursorwidth:"8px",cursorcolor:"rgb(200, 0, 0)"}),$(T+" .nicescroll-rails").detach().appendTo("body")),$("a").each(function(){$(this).parents("li").removeClass("active"),$(this).removeClass("active"),(this.href==e.href||this.href+"#"==e.href)&&($(this).parents("li").addClass("active"),$(this).addClass("active"))}),v&&v.startAutoPlay(),i&&i()}if($("#side-nav a").css("color",""),Modernizr.opacity&&($(T+" .page-paper").cssAnOnly({"background-color":""}),r.cssAn({"background-color":s})),$(".page-paper").each(function(){var e=$(this).getNiceScroll(0);e&&e.hide()}),Modernizr.cssanimations){var a=function(){var e=y<x.length-1?y+1:0,n=x[y];return y=e,n}(),d=function(){var e=C<S.length-1?C+1:0,n=S[C];return C=e,n}();n.find(".page-box").addClass("animated "+d),n.removeClass("out "+k.join(" ")).addClass("over in"),n.one(I,o),n.addClass("animated "+a)}else n.addClass("over in"),n.css({left:"-100%"}),n.animate({left:"0"},o)}function g(){c();var e="video-bg-wrap";d(e,O,function(e,n){l(e,function(){n.link&&n.author&&$(T+" .bg-author").text("Видео: ").append('<a target="_blank" href="'+n.link+'">'+n.author+"</a>"),h(V,e,function(){e[0].play()})})})}function w(){c();var e="sketch-bg-wrap";d(e,j,function(e,n){l(e,function(){n.link&&n.author&&$(T+" .bg-author").text("Фон: ").append('<a target="_blank" href="'+n.link+'">'+n.author+"</a>"),h(V,e,function(){i()})})})}function E(){c(),o(function(e){$bg=$(e),$bg.addClass("bg"),l($bg,function(){h(V,$bg)})})}var T=e.hash;T=T&&"#"!=T?T.replace("#!","#"):"#index",p=T;var V=$(T);if(!(V.length<1)){$(".page.in").length>0&&($("#side-nav a").css("color","#FF7D8D"),Modernizr.opacity&&r.cssAn({"background-color":"rgba(0, 0, 0, 0.7)"}));var B=function(){var e=[],n=function(){m&&e.push(g)},t=function(){e.push(w)},i=function(){f&&e.push(E)};return i(),i(),n(),n(),t(),t(),e}();B[L](),L<B.length-1?L++:L=0,$.cookie("lastFxCursor",L)}}var i=!1,o=!1,a=null,r=$("#side-nav"),s=r.css("background-color");$("a").each(function(){this.hash&&(this.hash=this.hash.replace("#","#!"))}),$(window).on("resize",function(){$("#page-wrapper>img.in").each(function(){adjustImg(this)})}),e(location),$("a").click(function(n){function t(){$(".video-bg video").each(function(){this.pause()}),$("#off").css({display:"none"}),$("#on").css({display:"block"}),r.cssAn({opacity:.3});var e=$("#off-bg");e.css({display:"table","background-image":"url(/images/fuzz.gif)"}),setTimeout(function(){e.cssAn({opacity:1})}),i=!0,a=location.hash}function s(){$("#off").css({display:"block"}),$("#on").css({display:"none"});var e=$("#off-bg");e.cssAn({opacity:0}),r.cssAn({opacity:1});var n=$.support.transition?300:T;setTimeout(function(){e.css({display:"none","background-image":"none"})},n);var t=$(".video-bg video.in");t.length>0&&($(".video-bg video").each(function(){this.pause()}),t[0].play()),i=!1}if("?off=1"===this.search)i||t(),n.preventDefault();else if("?on=1"==this.search)i&&s(),n.preventDefault();else if(o)n.preventDefault();else{i&&s();var d=location.hash?location.href.replace(location.hash,""):location.href.replace(/#$/,""),c=this.hash?this.href.replace(this.hash,""):this.href.replace(/#$/,"");this.hash&&c==d?(e(this),a=this.hash,location.hash=this.hash,n.preventDefault()):c==d&&(e(this),a="",location.hash="",n.preventDefault())}}),$(window).on("hashchange",function(){var n="#"==location.hash?"":location.hash;n!==a&&e(location)})}function r(){var e=$("#sequence");if(e.length>0){var n={nextButton:!0,prevButton:!0,pagination:!0,animateStartingFrameIn:!0,autoPlay:!0,pauseOnHover:!1,autoPlayDelay:3e3,preloader:!0,preloadTheseFrames:[1],preloadTheseImages:["images/newbigjob-t.png","images/newbigjob-m-t.png","images/mobivisor-t.png","images/surwave-t.png","images/surwave-m-t.png","images/vreggy-t.png","images/sigmahome-t.png","images/hitechhow-t.png","images/hth-crm-t.png","images/frescostudio-t.png"]},t=function(){$("#sequence>.sequence-canvas div[data-img]").each(function(){var e=$(this),n=e.attr("data-img"),t=$(window).width(),i=$(window).height();Modernizr.mq("only all")&&(580>=t||602>=i?n=n.replace(".png","-c.png"):925>=t||695>=i?n=n.replace(".png","-b.png"):(1199>=t||755>=i)&&(n=n.replace(".png","-a.png")));var o=e.find("img");(o.length<1||o.attr("src")!==n)&&(e.empty(),$('<img src="'+n+'" />').appendTo(e))})};$("#sequence .sequence-pagination .view").length<1&&($("#sequence>.sequence-canvas>li>.view").each(function(){var e=$(this).clone();e.find("div[data-img]").each(function(){var e=$(this);src=e.attr("data-img").replace(".png","-t.png"),$('<img src="'+src+'" />').appendTo(e)}),e.appendTo("#sequence .sequence-pagination")}),t(),$(window).on("resize",t)),v=$("#sequence").sequence(n).data("sequence"),v.pause()}}function s(){if(!Modernizr.opacity){for(var e=[["#top-nav",70],["#top-nav .navbar-toggle",80],["#top-nav .navbar-toggle:focus",20],["#top-nav li.navbar-text",80],["#side-nav",75],[".page-paper",90],[".page-content i",72],["#off-bg i",20],[".center-menu, .page-box",70],[".descr",70]],n=$("head"),t='<style type="text/css">',i=0;i<e.length;i++)t+=e[i][0]+' {-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity='+e[i][1]+')";}';t+="</style>",n.append($(t))}}function d(e){function n(){r=document.createElement("div"),$("#three-bg-wrap").append(r),s=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e5),s.position.z=3200,l=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e5),d=new THREE.Scene,u=new THREE.Scene;for(var e=new THREE.SphereGeometry(100,32,16),n="textures/cube/skybox-blue/",i=".jpg",o=[n+"px"+i,n+"nx"+i,n+"py"+i,n+"ny"+i,n+"pz"+i,n+"nz"+i],a=THREE.ImageUtils.loadTextureCube(o,new THREE.CubeRefractionMapping),p=new THREE.MeshBasicMaterial({color:16777215,envMap:a,refractionRatio:.95}),v=0;500>v;v++){var g=new THREE.Mesh(e,p);g.position.x=1e4*Math.random()-5e3,g.position.y=1e4*Math.random()-5e3,g.position.z=1e4*Math.random()-5e3,g.scale.x=g.scale.y=g.scale.z=3*Math.random()+1,d.add(g),h.push(g)}var w=THREE.ShaderLib.cube;w.uniforms.tCube.value=a;var p=new THREE.ShaderMaterial({fragmentShader:w.fragmentShader,vertexShader:w.vertexShader,uniforms:w.uniforms,depthWrite:!1,side:THREE.BackSide}),g=new THREE.Mesh(new THREE.CubeGeometry(100,100,100),p);u.add(g),c=new THREE.WebGLRenderer,c.setSize(window.innerWidth,window.innerHeight),c.autoClear=!1,r.appendChild(c.domElement),window.addEventListener("resize",t,!1)}function t(){g=window.innerWidth/2,w=window.innerHeight/2,s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight)}function i(e){p=10*(e.clientX-g),v=10*(e.clientY-w)}function o(){V&&(requestAnimationFrame(o),a())}function a(){for(var e=1e-4*Date.now(),n=0,t=h.length;t>n;n++){var i=h[n];i.position.x=5e3*Math.cos(e+n),i.position.y=5e3*Math.sin(e+1.1*n)}s.position.x+=.05*(p-s.position.x),s.position.y+=.05*(-v-s.position.y),s.lookAt(d.position),l.rotation.copy(s.rotation),c.render(u,l),c.render(d,s)}if(!e)return void(V=!1);V=!0;var r,s,d,c,l,u,h=[],p=0,v=0,g=window.innerWidth/2,w=window.innerHeight/2;document.addEventListener("mousemove",i,!1),n(),o(),e(r)}function c(e){function n(){for(d=document.createElement("div"),$("#three-bg-wrap").append(d),c=new THREE.PerspectiveCamera(55,window.innerWidth/window.innerHeight,2,2e3),c.position.z=1e3,l=new THREE.Scene,l.fog=new THREE.FogExp2(0,.001),p=new THREE.Geometry,f=THREE.ImageUtils.loadTexture("textures/sprites/disc.png"),g=0;1e4>g;g++){var e=new THREE.Vector3;e.x=2e3*Math.random()-1e3,e.y=2e3*Math.random()-1e3,e.z=2e3*Math.random()-1e3,p.vertices.push(e)}v=new THREE.ParticleSystemMaterial({size:35,sizeAttenuation:!1,map:f,transparent:!0}),v.color.setHSL(1,.3,.7),h=new THREE.ParticleSystem(p,v),h.sortParticles=!0,l.add(h),u=new THREE.WebGLRenderer({clearAlpha:1}),u.setSize(window.innerWidth,window.innerHeight),d.appendChild(u.domElement),document.addEventListener("mousemove",i,!1),document.addEventListener("touchstart",o,!1),document.addEventListener("touchmove",a,!1),window.addEventListener("resize",t,!1)}function t(){b=window.innerWidth/2,T=window.innerHeight/2,c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}function i(e){m=e.clientX-b,E=e.clientY-T}function o(e){1==e.touches.length&&(e.preventDefault(),m=e.touches[0].pageX-b,E=e.touches[0].pageY-T)}function a(e){1==e.touches.length&&(e.preventDefault(),m=e.touches[0].pageX-b,E=e.touches[0].pageY-T)}function r(){B&&(requestAnimationFrame(r),s())}function s(){var e=5e-5*Date.now();c.position.x+=.05*(m-c.position.x),c.position.y+=.05*(-E-c.position.y),c.lookAt(l.position),w=360*(1+e)%360/360,v.color.setHSL(w,.5,.5),u.render(l,c)}if(!e)return void(B=!1);B=!0;var d,c,l,u,h,p,v,g,w,f,m=0,E=0,b=window.innerWidth/2,T=window.innerHeight/2;n(),r(),e(d)}function l(e){function n(){function e(e,n,t){return new THREE.Vector3(e,n,t)}function n(){var e=document.createElement("canvas");e.width=128,e.height=128;var n=e.getContext("2d");n.beginPath(),n.arc(64,64,60,0,2*Math.PI,!1),n.lineWidth=.5,n.stroke(),n.restore();var t=n.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return t.addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(.2,"rgba(255,255,255,1)"),t.addColorStop(.4,"rgba(200,200,200,1)"),t.addColorStop(1,"rgba(0,0,0,1)"),n.fillStyle=t,n.fill(),e}l=document.createElement("div"),$("#three-bg-wrap").append(l),u=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,2e3),u.position.set(0,150,400),h=new THREE.Scene;var a=new THREE.DirectionalLight(16777215,.5);a.position.set(0,-1,1),a.position.normalize(),h.add(a),w=new THREE.PointLight(16777215,2,300),w.position.set(0,0,0),h.add(w);var d="X40",c=new THREE.MeshFaceMaterial([new THREE.MeshLambertMaterial({color:16777215,shading:THREE.FlatShading,opacity:.95}),new THREE.MeshLambertMaterial({color:16777215})]),y=new THREE.TextGeometry(d,{size:70,height:25,curveSegments:4,font:"helvetiker",bevelEnabled:!0,bevelThickness:2,bevelSize:2,material:0,extrudeMaterial:1});y.computeVertexNormals(),y.computeBoundingBox();var S=-.5*(y.boundingBox.max.x-y.boundingBox.min.x);g=new THREE.Mesh(y,c),g.position.x=S,g.position.y=130,g.position.z=-50,g.rotation.x=0,g.rotation.y=2*Math.PI,v=new THREE.Object3D,v.add(g),h.add(v);var C=7e4,k=new THREE.Geometry,M={__pools:[],get:function(){return this.__pools.length>0?this.__pools.pop():(console.log("pool ran out!"),null)},add:function(e){this.__pools.push(e)}};for(i=0;C>i;i++)k.vertices.push(e(200*Math.random()-100,100*Math.random()+150,50*Math.random())),M.add(i);attributes={size:{type:"f",value:[]},pcolor:{type:"c",value:[]}};var z=n();texture=new THREE.Texture(z),texture.needsUpdate=!0,uniforms={texture:{type:"t",value:texture}};var P=new THREE.ShaderMaterial({uniforms:uniforms,attributes:attributes,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:THREE.AdditiveBlending,depthWrite:!1,transparent:!0});m=new THREE.ParticleSystem(k,P),m.dynamic=!0;for(var A=m.geometry.vertices,L=attributes.size.value,W=attributes.pcolor.value,D=0;D<A.length;D++)L[D]=50,W[D]=new THREE.Color(0),k.vertices[D].set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);v.add(m),m.y=800;var F=0,O=0;f=new THREE.Shape,f.moveTo(F+25,O+25),f.bezierCurveTo(F+25,O+25,F+20,O,F,O),f.bezierCurveTo(F-30,O,F-30,O+35,F-30,O+35),f.bezierCurveTo(F-30,O+55,F-10,O+77,F+25,O+95),f.bezierCurveTo(F+60,O+77,F+80,O+55,F+80,O+35),f.bezierCurveTo(F+80,O+35,F+80,O,F+50,O),f.bezierCurveTo(F+35,O,F+25,O+25,F+25,O+25);var j=0,N=function(){var e=M.get();return L[e]=200*Math.random()+100,e},q=function(e){var n=e.position;e.target.position=n;var t=e.target;if(t){j+=3e-4*I,j>1&&(j-=1),_+=35e-5*I,_>1&&(_-=1);var i=f.getPointAt(_);emitterpos.x=5*i.x-100,emitterpos.y=5*-i.y+400,w.position.x=emitterpos.x,w.position.y=emitterpos.y,w.position.z=100,k.vertices[t]=e.position,W[t].setHSL(j,.6,.1),w.color.setHSL(j,.8,.5)}},V=function(e){var n=e.target;n&&(W[n].setRGB(0,0,0),k.vertices[n].set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),M.add(e.target))};E=new SPARKS.Emitter(new SPARKS.SteadyCounter(500)),emitterpos=new THREE.Vector3(0,0,0),E.addInitializer(new SPARKS.Position(new SPARKS.PointZone(emitterpos))),E.addInitializer(new SPARKS.Lifetime(1,15)),E.addInitializer(new SPARKS.Target(null,N)),E.addInitializer(new SPARKS.Velocity(new SPARKS.PointZone(new THREE.Vector3(0,-5,1)))),E.addAction(new SPARKS.Age),E.addAction(new SPARKS.Accelerate(0,0,-50)),E.addAction(new SPARKS.Move),E.addAction(new SPARKS.RandomDrift(90,100,2e3)),E.addCallback("created",q),E.addCallback("dead",V),E.start(),p=new THREE.WebGLRenderer,p.setSize(window.innerWidth,window.innerHeight),l.appendChild(p.domElement);var B=new THREE.ShaderPass(THREE.FocusShader),G=new THREE.ShaderPass(THREE.CopyShader);effectFilm=new THREE.FilmPass(.5,.25,2048,!1);var U=THREE.TriangleBlurShader;T=new THREE.ShaderPass(U,"texture"),H=new THREE.ShaderPass(U,"texture");var K=15,X=K/window.innerWidth,Y=K/window.innerHeight;R=new THREE.ShaderPass(THREE.HorizontalBlurShader),x=new THREE.ShaderPass(THREE.VerticalBlurShader),R.uniforms.h.value=1/window.innerWidth,x.uniforms.v.value=1/window.innerHeight,T.uniforms.delta.value=new THREE.Vector2(X,0),H.uniforms.delta.value=new THREE.Vector2(0,Y),B.uniforms.sampleDistance.value=.99,B.uniforms.waveFactor.value=.003;var Q=new THREE.RenderPass(h,u);THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),b=new THREE.EffectComposer(p),b.addPass(Q),b.addPass(R),b.addPass(x),x.renderToScreen=!0,H.renderToScreen=!0,B.renderToScreen=!0,G.renderToScreen=!0,effectFilm.renderToScreen=!0,document.addEventListener("mousedown",o,!1),document.addEventListener("touchstart",r,!1),document.addEventListener("touchmove",s,!1),window.addEventListener("resize",t,!1)}function t(){z=window.innerWidth/2,P=window.innerHeight/2,u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),p.setSize(window.innerWidth,window.innerHeight),R.uniforms.h.value=1/window.innerWidth,x.uniforms.v.value=1/window.innerHeight;var e=15,n=e/window.innerWidth,t=e/window.innerHeight;T.uniforms.delta.value=new THREE.Vector2(n,0),H.uniforms.delta.value=new THREE.Vector2(0,t),b.reset()}function o(e){e.preventDefault(),M=e.clientX-z,C=S,E.isRunning()?E.stop():E.start()}function a(e){k=e.clientX-z,S=C+.02*(k-M)}function r(e){1===e.touches.length&&(e.preventDefault(),M=e.touches[0].pageX-z,C=S)}function s(e){1===e.touches.length&&(e.preventDefault(),k=e.touches[0].pageX-z,S=C+.05*(k-M))}function d(){G&&(requestAnimationFrame(d),c())}function c(){I=y*A.getDelta(),m.geometry.verticesNeedUpdate=!0,attributes.size.needsUpdate=!0,attributes.pcolor.needsUpdate=!0,v.rotation.y+=.05*(S-v.rotation.y),p.clear(),b.render(.1)}if(!e)return void(G=!1);G=!0;var l,u,h,p,v,g,w,f,m,E,b,T,H,R,x,y=50,S=0,C=0,k=0,M=0,z=window.innerWidth/2,P=window.innerHeight/2,I=1,A=new THREE.Clock,_=0;n(),d(),e(l),document.addEventListener("mousemove",a,!1)}function u(e,n){function t(){c=document.createElement("div"),$(c).addClass("video"),$("#three-bg-wrap").append(c),l=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e4),l.position.z=500,u=new THREE.Scene;var n=new THREE.DirectionalLight(16777215);n.position.set(.5,1,1).normalize(),u.add(n),h=new THREE.WebGLRenderer({antialias:!1}),h.setSize(window.innerWidth,window.innerHeight),c.appendChild(h.domElement),p=new THREE.Texture(e),p.minFilter=THREE.LinearFilter,p.magFilter=THREE.LinearFilter,p.format=THREE.RGBFormat,p.generateMipmaps=!1;var t,i,s,d,m,E,b,T,S;s=1/x,d=1/y,T=$(e).width()/2.3/x,S=$(e).height()/2.3/y;var C={color:16777215,map:p},k=new THREE.MeshLambertMaterial(C);for(h.initMaterial(k,u.__lights,u.fog),f=0,t=0;x>t;t++)for(i=0;y>i;i++)m=t,E=i,b=new THREE.CubeGeometry(T,S,T),a(b,s,d,m,E),R[f]=new THREE.MeshLambertMaterial(C),v=R[f],v.hue=t/x,v.saturation=1-i/y,v.color.setHSL(v.hue,v.saturation,.5),g=new THREE.Mesh(b,v),g.position.x=(t-x/2)*T,g.position.y=(i-y/2)*S,g.position.z=0,g.scale.x=g.scale.y=g.scale.z=1,u.add(g),g.dx=.001*(.5-Math.random()),g.dy=.001*(.5-Math.random()),H[f]=g,f+=1;h.autoClear=!1,document.addEventListener("mousemove",r,!1);var M=new THREE.RenderPass(u,l),z=new THREE.BloomPass(1.3),P=new THREE.ShaderPass(THREE.CopyShader);P.renderToScreen=!0,w=new THREE.EffectComposer(h),w.addPass(M),w.addPass(z),w.addPass(P),window.addEventListener("resize",o,!1)}function o(){b=window.innerWidth/2,T=window.innerHeight/2,l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),h.setSize(window.innerWidth,window.innerHeight),w.reset()}function a(e,n,t,i,o){for(var a=e.faceVertexUvs[0],r=0;r<a.length;r++)for(var s=a[r],d=0;d<s.length;d++){var c=s[d];c.x=(c.x+i)*n,c.y=(c.y+o)*t}}function r(e){m=e.clientX-b,E=.3*(e.clientY-T)}function s(){U[n]&&(requestAnimationFrame(s),d())}function d(){var n=5e-5*Date.now();for(l.position.x+=.05*(m-l.position.x),l.position.y+=.05*(-E-l.position.y),l.lookAt(u.position),e.readyState===e.HAVE_ENOUGH_DATA&&p&&(p.needsUpdate=!0),i=0;f>i;i++)v=R[i],S=360*(v.hue+n)%360/360,v.color.setHSL(S,v.saturation,.5);if(C%1e3>200)for(i=0;f>i;i++)g=H[i],g.rotation.x+=10*g.dx,g.rotation.y+=10*g.dy,g.position.x+=200*g.dx,g.position.y+=200*g.dy,g.position.z+=400*g.dx;if(C%1e3===0)for(i=0;f>i;i++)g=H[i],g.dx*=-1,g.dy*=-1;C++,h.clear(),w.render()}if(!e)return void(U[n]=!1);if(!U[n]){U[n]=!0;var c,l,u,h,p,v,g,w,f,m=0,E=0,b=window.innerWidth/2,T=window.innerHeight/2,H=[],R=[],x=20,y=10;t(),s();var S,C=1}}$.fn.cssAn=function(e){return Modernizr.cssanimations?this.css(e):this.animate(e,T)},$.fn.cssAnOnly=function(e){return Modernizr.cssanimations?this.css(e):this};var h,p,v,g=($("html").hasClass("ie8"),$("html").hasClass("ie9"),$("html").hasClass("ie10"),navigator.userAgent.toLowerCase().indexOf("chrome")>-1),w=-1!=navigator.appVersion.indexOf("Win"),f=function(){try{var e=document.createElement("canvas"),n=e.getContext("webgl")||e.getContext("experimental-webgl"),t=window.WebGLRenderingContext&&n?!0:!1,i=n.getSupportedExtensions(),o=w&&g&&-1==i.join().indexOf("compressed_texture");return t&&!o}catch(a){return!1}}(),m=function(){var e=document.createElement("video");return canMP4=e.canPlayType?e.canPlayType("video/mp4"):!1,canMP4&&f&&!Modernizr.touch}(),E=Modernizr.csstransforms,b=Modernizr.canvas,T=800,H=["slideInDown","fadeInLeft","slideInLeft","fadeInRight","slideInRight","fadeInDown","fadeInUp"],R=0,x=["fadeInLeft","fadeInDown","fadeInUp","fadeInRight"],y=0,S=["flipInX","bounceIn","pulse","bounce","shake","swing","bounceInLeft","flipInY"],C=0,k=["bounceOutRight","bounceOutLeft","bounceOutDown","bounceOutUp"],M=0,z=["bounceOutRight","bounceOutLeft","bounceOutDown","bounceOutUp"],P=0,I="animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",A=t,_=function(){function e(e){var n="last-cursor-"+e,t=$.cookie(n);return t?t:($.cookie(n,0),0)}return{"video-bg-wrap":e("video-bg-wrap"),"sketch-bg-wrap":e("sketch-bg-wrap")}}(),L=function(){var e=$.cookie("lastFxCursor");return e?e:($.cookie("lastFxCursor",0),0)}(),W=function(){var e=$.cookie("lastSketchCursor");return e?e:($.cookie("lastSketchCursor",0),0)}(),D=function(){var e=$.cookie("lastThreeCursor");return e?e:($.cookie("lastThreeCursor",0),0)}(),F=1,O=[{src:"video/cross6_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/datacity_(loop)_1280x720.mp4",w:1280,h:720,link:"http://vimeo.com/29966720",author:"beeple"},{src:"video/rmx_(loop)_1280x560.mp4",w:1280,h:560,audio:!0,link:"http://vimeo.com/79293746",author:"beeple"}],j=[{src:"video/lightgrid_(loop)_1280x720.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-a.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-a.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-c.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-c.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"},{src:"video/lightgrid_(loop)_1280x720-b.jpg",w:1280,h:720,link:"http://vimeo.com/76432043",author:"beeple"},{src:"video/cross6_(loop)_1280x720-b.jpg",w:1280,h:720,link:"http://vimeo.com/11162767",author:"beeple"}],N=[{src:"pde/hello-processing.pde"},{src:"pde/swarming-circles.pde"},{src:"pde/motion-frequency.pde"}],q=[{func:d},{func:l},{func:c}];o(),r(),e(j,"sketch-bg-wrap"),m&&e(O,"video-bg-wrap"),a(),s();var V,B,G,U=[]})}).call(this);